<!DOCTYPE html>
<html>
<head>
    <title>PixelArt</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.0/css/bootstrap.min.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.0/js/bootstrap.min.js"></script>
<script src="https://use.fontawesome.com/releases/v5.0.8/js.all.js"> </script>    
<link href="https://fonts.googleapis.com/css?family=Merriweather:400,700i" rel="stylesheet">
<link href="https://fonts.googleapis.com/css?family=Playball" rel="stylesheet">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Pacifico|Press+Start+2P"> 
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Arimo:400,700i">    
<link href="overlay.css" rel="stylesheet">    
</head>
<body>
<div id="myNav" class="overlay">
  <a href="javascript:void(0)" class="closebtn" onclick="closeNav()">&times;</a>
  <div class="overlay-content">
      <h1 style="font-size: 50px; color: beige">About</h1>
      <h1>Pixel</h1>
      <p>
      A minute area of illumination on a display screen, one of many from which an image is composed.
      </p><br/><br/>
      <h1>Pixel Art</h1>
    <p>
        It is a form of digital art, created through the use of software, where images are edited on the pixel level.<br> 
        The aesthetic for this kind of graphics comes from 8-bit and 16-bit computers and video game consoles, in addition to<br> other limited systems such as graphing calculators. In most pixel art, the color palette used is extremely limited in size, with <br>some pixel art using only two colors.
    </p>
  </div>
</div>
<nav>
    <ul >
    <li style="cursor:pointer; float: left; font-size: 30px; text-align: justify; color: floralwhite" onclick="openNav()">&#9776; About</li>
    <li><a href="#draw">Pixel Maker</a></li>
     <li><a href="#convert">Pixel Converter</a></li>    
    </ul>
</nav>
 <container> 
<div id="draw">
    <p style="font-size: 45px; color: black; font-family: 'Merriweather', serif; padding-bottom: 15px">Draw Sprites</p>
    <h4>Choose Grid Size</h4>
    <form id="sizePicker">
    <p style="color: black">Enter a number between 1 to 20.</p>
        Grid Height:
        <input type="number" id="input_height" name="height" min="1" max="20" required>
        Grid Width:
        <input type="number" id="input_width" name="width"  min="1" max="20" required>
        <input type="submit">
    </form>
    <h4>Pick A Color</h4>
    <input type="color" id="colorPicker">

    <h4>Design Canvas</h4>
    <table id="pixel_canvas"></table>
    <input type="button" id="toggleBtn" value="Toggle Grid">    
</div>  </container>    
<container id="convert">  
<section class="drop">
  <div class="content">
      <p style="font-size: 45px; color: black; font-family: 'Merriweather', serif; padding-bottom: 35px">Convert Image into Pixel</p>
    <div class="drop-zone drop-placeholder" style="font-family: 'Merriweather', serif"><span>DROP IMAGE HERE (64px-64px)</span>
      <img class="drop-image">
    </div>
  </div>
</section>
<section class="scale">
  <div class="label">
    <h3>SCALE</h3>
    <h5>&times 10</h5>
  </div>
  <div class="content">
    <input class="scale-slider" type="range" min="1" max="20" step="1" value="10">
    <div class="scale-labels">
      <div class="scale-min">smaller</div>
      <div class="scale-max">bigger</div>
    </div>
  </div>
</section>
<section class="preview">
  <div class="label">
    <h3>PREVIEW</h3>
  </div>
  <div class="content">
    <div class="preview-box">
      <div class="preview-anchor"></div>
    </div>
  </div>
</section>   
</container> 
    
    
    
<script>
function openNav() {
  document.getElementById("myNav").style.width = "100%";
}

function closeNav() {
  document.getElementById("myNav").style.width = "0%";
}
        
//Javascript code used to create a table for pixel art.

$('#sizePicker').submit(function makeGrid(event) {  
  $('table tr').remove();                          
var rows=$('#input_height').val();                 
var cells=$('#input_width').val();                 
  for (var i=1;i<=rows;i++) {
    $('table').append("<tr></tr>");
    for (var j=1;j<=cells;j++) {
      $( 'tr:last').append("<td></td>");         
      $('td').attr('class','pixel');
    }
  }
  event.preventDefault();                       
});

//Javascript code used to select and apply color to the cell of the canvas.
$('#pixel_canvas').on('click','.pixel',function(){  
  var pen=$('#colorPicker').val();
  $(this).css('background-color',pen);
});
        
// Toggle the grid after creating the pixel art..Take a screenshot/use snipping tool...
$('#toggleBtn').click('.pixel_canvas',function (){
    $('td').toggleClass('grid_Toggle');
});

    
    
/*js for convert part*/
    
var dropImage; // global, set when image changes

$(function() {
  // suppress assets pop-up for codepen pro accounts
  $('html').on('dragenter dragover', function(e) {
    e.stopPropagation();s
  });
  
  // image changed
  $('.drop-image').on('load', function() {
    if (this.naturalWidth > 64 || this.naturalHeight > 64) {
      showDropError('IMAGE TOO LARGE');
    } else {
      dropImage = this;
      calculatePixels();
      renderDrop();
      renderMarkup();
    }
  });
  
  // drag and drop stuff
  $('.drop-zone')
    .on('dragover', function() {
      $(this).addClass('drop-over');
      return false;
    })
    .on('dragleave', function() {
      $(this).removeClass('drop-over');
      return false;
    })
    .on('drop', function(e) {
      $(this).removeClass('drop-over');
      loadFromDesktop(e.originalEvent.dataTransfer.files[0]);
      e.preventDefault();
      return false;
    });
  

  // scale slider
  $('.scale-slider').on('change', function() {
    updateScale(this.value);
  });
});

function loadFromDesktop(file) {
  if (!file || file.type.indexOf('image/') !== 0) {
    showDropError('NOT AN IMAGE');
  } else {
    var reader = new FileReader();
    reader.onload = function(e) {
      $('.drop-image').attr('src', e.target.result);
    };
    reader.readAsDataURL(file);
  }
}

function showDropError(message) {
  $('body').removeClass('loaded');
  $('.drop-image').hide();
  $('.drop-placeholder')
    .text(message)
    .addClass('error')
    .show();
}

function loadFromSamples(src) {
  $('.drop-image').attr('src', src);
}

function updateScale(scale) {
  $('.scale h5').html('&times; ' + scale);
  renderMarkup();
}

function calculatePixels() {
  // create context
  var canvas = document.createElement('canvas');
  canvas.width = dropImage.naturalWidth;
  canvas.height = dropImage.naturalHeight;
  var context = canvas.getContext('2d');
  
  // draw green screen
  context.beginPath();
  context.rect(0, 0, dropImage.naturalWidth, dropImage.naturalHeight);
  context.fillStyle = 'rgb(1, 255, 1)';
  context.fill();
  
  // get image data
  context.drawImage(dropImage, 0, 0);
  var data = context.getImageData(0, 0, dropImage.naturalWidth, dropImage.naturalHeight).data;
  
  // translate image data to pixel objects
  var pixels = [];
  for (var i = 0; i < dropImage.naturalWidth * dropImage.naturalHeight; i++) {
    var r = data[i * 4];
    var g = data[i * 4 + 1];
    var b = data[i * 4 + 2];
    
    if(r !== 1 || g !== 255 || b !== 1) {
      pixels.push({
        x: i % dropImage.naturalWidth,
        y: Math.floor(i / dropImage.naturalWidth),
        hex: rgbToHex(r, g, b)
      });
    }
  }
  
  // save work
  dropImage.pixels = pixels;
}

function renderDrop() {
  // show drop image centered
  $(dropImage)
    .show()
    .css('margin', (dropImage.naturalHeight / -2) + 'px 0 0 ' + (dropImage.naturalWidth / -2) + 'px');

  // update UI
  $('.drop-placeholder').hide();
  $('.drop h4').html(dropImage.naturalWidth + 'px &times; ' + dropImage.naturalHeight + 'px');
  $('body').addClass('loaded');
}

function renderMarkup() {
  var scale = parseInt($('.scale-slider').val(), 10);
  var marginLeft = (dropImage.naturalWidth - 1) * scale;
  var marginBottom = (dropImage.naturalHeight - 1) * scale;

  var bgColor;
  var shadows = [];
  for (var i = 0; i < dropImage.pixels.length; i++) {
    var pixel = dropImage.pixels[i];
    
    if (i === 0 && pixel.x === 0 && pixel.y === 0) {
      // topmost leftmost pixel becomes background color
      bgColor = pixel.hex;
    }
    else {
      // add a box shadow
      var x = pixel.x * scale;
      if (x !== 0) {
        x += 'px';
      }
      var y = pixel.y * scale;
      if (y !== 0) {
        y += 'px';
      }
      shadows.push(x + ' ' + y + ' ' + pixel.hex);
    }
  }
  
  // create style string
  var style =
    'display: inline-block;\n' +
    'width: ' + scale + 'px;\n' +
    'height: ' + scale + 'px;\n' +
    'margin: 0 ' + marginLeft + 'px ' + marginBottom + 'px 0;\n' +
    (bgColor ? 'background-color: ' + bgColor + ';\n' : '') +
    'box-shadow:\n  ' + shadows.join(',\n  ') + ';';
  
  // update preview stuff
  $('.preview-anchor').attr('style', style);
  $('.preview h5').html((dropImage.naturalWidth * scale) + 'px &times; ' + (dropImage.naturalHeight * scale) + 'px');

  // update css stuff
  $('.css-output').val(style);
  $('.css h5').html(style.match(/\n/g).length + ' lines');
}

function rgbToHex(r, g, b) {
  var hex = ((1 << 24) + (r << 16) + (g << 8) + b)
    .toString(16)
    .slice(1);
  
  // short format
  if (hex[0] === hex[1] && hex[2] === hex[3] && hex[4] === hex[5]) {
    hex = hex[0] + hex[2] + hex[3];
  }
  
  return '#' + hex;
}
</script>     
     
</body>
</html>
